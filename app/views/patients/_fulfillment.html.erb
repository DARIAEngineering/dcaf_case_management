<section id="pledge_fulfillment_content">
  <%= bootstrap_form_for patient, html: { id: 'pledge_fulfillment_form' }, remote: true do |f| %>
    <div class="col-sm-12">
      <div class="row">
        <div class="col-sm-12">
          <h2>Pledge Fulfillment</h2>
          <p>Please confirm that the clinic and pledge amounts are correct:</p>
          <ul>
            <li>Clinic: <%= @patient.clinic.try(:name) %></li>
            <li><%= FUND %> Pledge Amount: $<%= @patient.fund_pledge %></li>
            <li>Pledge generated by: <%= @patient.pledge_generated_by.try(:name) || 'N/A' %></li>
            <li>Pledge generated at: <%= @patient.pledge_generated_at.try(:display_date) || 'N/A' %></li>
            <li>Pledge sent by: <%= @patient.pledge_sent_by.try(:name) ||  'N/A' %></li>
            <li>Pledge sent at: <%= @patient.pledge_sent_at.try(:display_date) || 'N/A'%></li>
          </ul>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <%= f.fields_for patient.fulfillment do |pt| %>
            <%= pt.form_group :fulfilled do %>
              <%= pt.check_box :fulfilled, label: 'Pledge fulfilled', autocomplete: 'off' %>
            <% end %>
          <% end %>
        </div>
        <div class="info-form-left col-sm-6">
          <%= f.fields_for patient.fulfillment do |pt| %>
            <%= pt.number_field :fund_payout,
                                label: "#{FUND} payout",
                                autocomplete: 'off',
                                prepend: '$'%>
            <%= pt.select :gestation_at_procedure,
                          options_for_select(weeks_options, patient.fulfillment.gestation_at_procedure),
                          label: 'Weeks along at procedure',
                          autocomplete: 'off' %>
            <%= pt.date_field :procedure_date,
                                  label: 'Procedure date',
                                  autocomplete: 'off' %>
          <% end %>
        </div>
        <div class="info-form-right col-sm-6">
          <%= f.fields_for patient.fulfillment do |pt| %>
            <%= pt.text_field :check_number, label: 'Check #', autocomplete: 'off'%>
            <%= pt.date_field :date_of_check, label: 'Date of check', autocomplete: 'off' %>
          <% end %>
        </div>
      </div>
      <h3>Auditing</h3>
      <div class="row">
        <div class="col-sm-12">
          <%= f.fields_for patient.fulfillment do |pt| %>
            <%= pt.form_group :audited do %>
              <%= pt.check_box :audited, label: 'Fulfillment audited?', autocomplete: 'off' %>
            <% end %>
          <% end %>
        </div>
        <div class="col-sm-12">
          <p class="archive-note">Patient will be archived on <%= patient.archive_date %></p>
        </div>
      </div>
    </div>
  <% end %>
</section>
